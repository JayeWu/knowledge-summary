## 1 Web请求过程 ##
### 1.1 B/S与C/S网络架构 ###
* C/S
	* Client/Server，客户端/服务端，如手机中的应用：QQ，微博
	* 采用长连接的交互方式
	* 使用自定义的应用层协议
* B/S
	* Browser/Server，浏览器/服务器，网页
	* 客户端使用统一的浏览器，不需要特殊的配置和网络连接
	* 服务端基于统一的HTTP，规范开发模式，节省开发成本
		* 基于HTTP的服务器：Apache、IIS、Tomcat、Nginx、JBoss
		* 这些服务器可以直接拿来使用，不需要单独开发

### 1.2 URL和URI的区别 ###
* URL是URI的一种，URI不一定是URL
* 让URI能成为URL的当然就是那个“访问机制”，“网络位置”
	* http:// or ftp:// or ldap:// ...
* URI可以分为URL,URN或同时具备locators 和names特性的一个东西
	* 可以没有URL，但是必须有URN
	* URN可以当作一个人的名字
	* URL可以当作一个人的地址
* URI：uniform resource identifier，统一资源标识符，用来唯一的标识一个资源
* URL：uniform resource locator，统一资源定位器，它是一种具体的URI，即URL可以用来标识一个资源，而且还指明了如何locate这个资源
* URN：uniform resource name，统一资源命名，是通过名字来标识资源

### 1.3 如何发起一个请求 ###
* 如何发起一个HTTP请求和如何建立一个Socket连接区别不大
* 只不过 outputStream.write**写的二进制数据格式要符合HTTP**
* 在建立连接之前先DNS出IP地址和端口，再与远程服务器建立Socket连接
* 通过outputStream.write将请求发送到目标服务器，等待inputStream.read返回数据
* 最后断开这个连接

### 1.4 浏览器缓存机制 ###
* 如果浏览页面发现异常情况，通常考虑是不是浏览器做了缓存
* 按 CTRL+F5刷新页面，浏览器会直接向目标URL发送请求，而不会使用浏览器缓存的数据
* 但是若应用服务器前端部署了一个缓存服务器，可能访问到的仍然是缓存数据
* 为了保证数据的最新，必须通过HTTP控制

**在请求头中加配置项**  

* Cache-Control/Pragma
	* no-cache:所用内容不会被缓存
* Expires
	* 后面更一个时间，超过该时间，缓存失效
* Last-Modified/Etag 

### 1.5 DNS 域名解析 ###
1. 浏览器先检查缓存中有没有这个域名对应的解析过的IP地址，如果有结束
	1. 浏览器缓存域名是有限制的，缓存大小和时间都可以设定，但时间太长，ip变化后无法访问，太短则每次都要重新解析
2. 如果缓存没命中，浏览器会查找操作系统缓存中是否有这个域名对应的DNS解析结果！hosts文件中，自己可以灵活的设定
3. 如果本地没命中，则请求域名服务器
	1. 我们的网络配置中都会有 “DNS服务器地址”这一项
4. 如果LDNS仍然没有命中，就直接到Root Server域名服务器请求解析
5. 根域名服务器返回给本地域名服务器一个所查询域的**主域名服务器**（gTLD Server）地址
	1. gTLD是国际顶级域名服务器，如：.com、.cn、.org等
6. 本地域名服务器（Local DNS Server）再向上一步返回的gTLD服务器发送请求
7. 接受请求的gTLD服务器查询并返回此域名对应的Name Server域名服务器的地址
	1. 这个Name Server 通常就是你注册的域名服务器，域名提供商的服务器来完成解析
8. Name Server 域名服务器会查询存储的域名和IP的映射关系表
	1. 正常情况下都根据域名得到目标IP记录，连同一个TTL值返回给DNS Server域名服务器
9. 返回该域名对应的IP和TTL值，Local DNS Server 会缓存这个域名和IP的对应关系，时间有TTL值控制
10. 把解析结果返回给用户，用户根据TTL值缓存在本地系统中，域名解析过程结束

#### 1.5.1 清楚缓存的域名 ####
* ipconfig/flushdns --win刷新缓存
* /etc/init.d/nscd restart --linux刷新缓存

#### 几种域名解析方法 ####
* A记录
* MX记录
* CNAME记录
* NS记录
* TXT记录


### 1.6 CDN工作机制 ###
* 内容分布网络（Content Delivery Network），是构建在internet的一种先进的流量分配网络
* CDN=镜像+缓存+整体负载均衡
* 以缓存网站中的静态数据为主
	* CSS、JS、图片和静态页面等数据
	* 用户在从主站服务器请求到动态内容后，再从CDN上下载这些静态数据，从而加速网页数据内容的下载速度

#### 1.6.1 CDN达到的目标 ####
* 可扩展性
	* 性能可扩展：应对新增大量数据的扩展能力
	* 成本可扩展：
* 安全性：减少DDOS等恶意攻击
* 可靠性、响应和执行

#### 1.6.2 CDN动态加速 ####
* 在CDN的DNS解析中，通过动态的链路探测来寻找回源最好的一条路径，从而加速用户的访问效率